{"version":3,"file":"ngx-img-fallback.js","sources":["ng://ngx-img-fallback/src/app/modules/ngx-img-fallback/ngx-img-fallback.directive.ts","ng://ngx-img-fallback/src/app/modules/ngx-img-fallback/ngx-img-fallback.module.ts","ng://ngx-img-fallback/src/app/modules/ngx-img-fallback/index.ts","ng://ngx-img-fallback/public_api.ts","ng://ngx-img-fallback/ngx-img-fallback.ts"],"sourcesContent":["/**\n * Created by vadimdez on 28/01/2018.\n */\nimport { Directive, ElementRef, Input, Output, EventEmitter, OnDestroy, Renderer2 } from '@angular/core';\n\n@Directive({\n  selector: '[src-fallback]'\n})\nexport class ImgFallbackDirective implements OnDestroy {\n\n  @Input('src-fallback') imgSrc: string;\n  @Output('loaded') loaded = new EventEmitter<boolean>();\n  private nativeElement: HTMLElement;\n  private isApplied: boolean = false;\n  private ERROR_EVENT_TYPE: string = 'error';\n  private LOAD_EVENT_TYPE: string = 'load';\n  private cancelOnError: Function;\n  private cancelOnLoad: Function;\n\n  constructor(private el: ElementRef, private renderer: Renderer2) {\n    this.nativeElement = el.nativeElement;\n\n    this.onError = this.onError.bind(this);\n    this.onLoad = this.onLoad.bind(this);\n    this.addEvents();\n  }\n\n  ngOnDestroy() {\n    this.removeErrorEvent();\n    this.removeOnLoadEvent();\n  }\n\n  private onError() {\n    if (this.nativeElement.getAttribute('src') !== this.imgSrc) {\n      this.isApplied = true;\n      this.renderer.setAttribute(this.nativeElement, 'src', this.imgSrc);\n    } else {\n      this.removeOnLoadEvent();\n    }\n  }\n\n  private onLoad() {\n    this.loaded.emit(this.isApplied);\n  }\n\n  private removeErrorEvent() {\n    if (this.cancelOnError) {\n      this.cancelOnError();\n    }\n  }\n\n  private removeOnLoadEvent() {\n    if (this.cancelOnLoad) {\n      this.cancelOnLoad();\n    }\n  }\n\n  private addEvents() {\n    this.cancelOnError = this.renderer.listen(this.nativeElement, this.ERROR_EVENT_TYPE, this.onError);\n    this.cancelOnLoad = this.renderer.listen(this.nativeElement, this.LOAD_EVENT_TYPE, this.onLoad);\n  }\n}\n","/**\n * Created by vadimdez on 27/11/2016.\n */\nimport { NgModule } from '@angular/core';\n\nimport { ImgFallbackDirective } from './ngx-img-fallback.directive';\n\n@NgModule({\n  declarations: [ImgFallbackDirective],\n  exports: [ImgFallbackDirective]\n})\nexport class ImgFallbackModule { }\n","/**\n * Created by Vadym Yatsyuk on 28.01.18\n */\n\nexport * from './ngx-img-fallback.module';\nexport * from './ngx-img-fallback.directive';","/**\n * Created by Vadym Yatsyuk on 28.01.18\n */\nexport * from './src/app/modules/ngx-img-fallback/index';","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public_api';\n"],"names":["tslib_1.__decorate"],"mappings":";;;;IAmBE,8BAAoB,EAAc,EAAU,QAAmB;QAA3C,OAAE,GAAF,EAAE,CAAY;QAAU,aAAQ,GAAR,QAAQ,CAAW;QAR7C,WAAM,GAAG,IAAI,YAAY,EAAW,CAAC;QAE/C,cAAS,GAAY,KAAK,CAAC;QAC3B,qBAAgB,GAAW,OAAO,CAAC;QACnC,oBAAe,GAAW,MAAM,CAAC;QAKvC,IAAI,CAAC,aAAa,GAAG,EAAE,CAAC,aAAa,CAAC;QAEtC,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QACvC,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QACrC,IAAI,CAAC,SAAS,EAAE,CAAC;KAClB;IAED,0CAAW,GAAX;QACE,IAAI,CAAC,gBAAgB,EAAE,CAAC;QACxB,IAAI,CAAC,iBAAiB,EAAE,CAAC;KAC1B;IAEO,sCAAO,GAAf;QACE,IAAI,IAAI,CAAC,aAAa,CAAC,YAAY,CAAC,KAAK,CAAC,KAAK,IAAI,CAAC,MAAM,EAAE;YAC1D,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;YACtB,IAAI,CAAC,QAAQ,CAAC,YAAY,CAAC,IAAI,CAAC,aAAa,EAAE,KAAK,EAAE,IAAI,CAAC,MAAM,CAAC,CAAC;SACpE;aAAM;YACL,IAAI,CAAC,iBAAiB,EAAE,CAAC;SAC1B;KACF;IAEO,qCAAM,GAAd;QACE,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;KAClC;IAEO,+CAAgB,GAAxB;QACE,IAAI,IAAI,CAAC,aAAa,EAAE;YACtB,IAAI,CAAC,aAAa,EAAE,CAAC;SACtB;KACF;IAEO,gDAAiB,GAAzB;QACE,IAAI,IAAI,CAAC,YAAY,EAAE;YACrB,IAAI,CAAC,YAAY,EAAE,CAAC;SACrB;KACF;IAEO,wCAAS,GAAjB;QACE,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,IAAI,CAAC,aAAa,EAAE,IAAI,CAAC,gBAAgB,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC;QACnG,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,IAAI,CAAC,aAAa,EAAE,IAAI,CAAC,eAAe,EAAE,IAAI,CAAC,MAAM,CAAC,CAAC;KACjG;IAlDsBA;QAAtB,KAAK,CAAC,cAAc,CAAC;;wDAAgB;IACpBA;QAAjB,MAAM,CAAC,QAAQ,CAAC;;wDAAsC;IAH5C,oBAAoB;QAHhC,SAAS,CAAC;YACT,QAAQ,EAAE,gBAAgB;SAC3B,CAAC;yCAYwB,UAAU,EAAoB,SAAS;OAXpD,oBAAoB,CAqDhC;IAAD,2BAAC;CArDD;;;ICGA;KAAkC;IAArB,iBAAiB;QAJ7B,QAAQ,CAAC;YACR,YAAY,EAAE,CAAC,oBAAoB,CAAC;YACpC,OAAO,EAAE,CAAC,oBAAoB,CAAC;SAChC,CAAC;OACW,iBAAiB,CAAI;IAAD,wBAAC;CAAlC;;ACXA;;GAEG;;ACFH;;GAEG;;ACFH;;GAEG;;;;"}